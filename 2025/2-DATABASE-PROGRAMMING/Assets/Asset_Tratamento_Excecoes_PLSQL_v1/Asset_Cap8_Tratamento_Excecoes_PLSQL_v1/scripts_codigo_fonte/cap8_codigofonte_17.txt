-- Instrução SQL que agrupa as vendas dos produtos por ano.
SELECT  P.CD_PRODUTO,
		EXTRACT( YEAR FROM P.DT_PEDIDO) ANO_VENDA,
		COUNT(IP.QT_PEDIDO) QTD_TOT_PRODUTO    
FROM    DB_PRODUTO P INNER JOIN DB_PRODUTO_LOJA PL 
ON      (P.CD_PRODUTO = PL.CD_PRODUTO) INNER JOIN DB_ITEM_PEDIDO IP
ON		(PL.CD_PRODUTO_LOJA = IP.CD_PRODUTO_LOJA) INNER JOIN DB_PEDIDO P
ON		(IP.NR_LOJA = P.NR_LOJA AND IP.NR_PEDIDO = P.NR_PEDIDO)
GROUP BY  P.CD_PRODUTO,
        EXTRACT( YEAR FROM P.DT_PEDIDO);

