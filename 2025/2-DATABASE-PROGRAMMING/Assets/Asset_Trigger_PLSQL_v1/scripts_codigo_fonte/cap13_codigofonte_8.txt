--
-- TRIGGER TRG_DB_PEDIDO_ATUALIZA_CLIENTE QUE ATUALIZA
-- ALGUMAS INFORMAÇÕES DO CLIENTE NO MOMENTO EM QUE ELE
-- FAZ UM PEDIDO
--
CREATE OR REPLACE TRIGGER TRG_DB_PEDIDO_ATUALIZA_CLIENTE 
AFTER INSERT ON DB_PEDIDO
FOR EACH ROW
BEGIN
  UPDATE  DB_CLIENTE
  SET     QT_PEDIDOS_REALIZADOS =   NVL(QT_PEDIDOS_REALIZADOS, 0) + 1,
          DT_ULTIMA_COMPRA = SYSDATE
  WHERE NR_CLIENTE = :NEW.NR_CLIENTE;
END TRG_DB_PEDIDO_ATUALIZA_CLIENTE;
