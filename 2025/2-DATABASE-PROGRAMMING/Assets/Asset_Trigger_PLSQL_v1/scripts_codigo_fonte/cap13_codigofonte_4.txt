CREATE OR REPLACE TRIGGER TRG_DB_VALIDA_VALOR_TOT_PEDIDO
BEFORE INSERT ON DB_PEDIDO
FOR EACH ROW
BEGIN
  IF :NEW.vl_tot_pedido < 0 THEN
    RAISE_APPLICATION_ERROR(-20001, 'Loja(' || :NEW.nr_loja || ') e o Pedido(' || :NEW.nr_pedido || 
    '). O valor do pedido SEMPRE DEVE ser maior ou igual a zero.' || 
    'Impossível de prosseguir!');
  END IF;
END TRG_DB_VALIDA_VALOR_TOT_PEDIDO;

--
-- ACIONANDO A TRIGGER DE REGRA DE NEGÓCIO
-- QUE NÃO DEIXA GRAVAR PEDIDOS COM VALORES NEGATIVOS.
INSERT INTO DB_PEDIDO(
NR_LOJA, NR_PEDIDO, NR_MATRICULA_FUNC_ATD, CD_FORMA_PAGTO,
NR_CLIENTE, CD_LOGRADOURO_CLI, DT_PEDIDO, VL_TOT_PEDIDO, ST_PEDIDO)
VALUES
(
1, 2001, 3, 2,
8,90, SYSDATE, -25678.90, 'A');

