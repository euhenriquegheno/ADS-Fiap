CREATE OR REPLACE FUNCTION FUN_DB_PEGA_NOME_CLIENTE(
P_NR_CLIENTE DB_CLIENTE.NR_CLIENTE%TYPE) RETURN VARCHAR2
IS
	-- VARIÁVEL DO TIPO DE DADO DA COLUNA, POIS VAMOS RETORNAR O NOME DO CLIENTE 
	-- A PARTIR DE SEU CÓDIGO QUE REPRESENTA A CHAVE PK.
    V_NM_CLIENTE DB_CLIENTE.NM_CLIENTE%TYPE;
BEGIN
	
    DBMS_OUTPUT.PUT_LINE('ESTAMOS DENTRO DA FUNCTION E O VALOR DO PARÂMETRO P_NR_CLIENTE É:' || P_NR_CLIENTE);
    
	BEGIN
		SELECT NM_CLIENTE
		INTO 	V_NM_CLIENTE
		FROM	DB_CLIENTE
		WHERE	NR_CLIENTE = P_NR_CLIENTE;
	
        DBMS_OUTPUT.PUT_LINE('ENCONTRAMOS O NOME DO CLIENTE NÚMERO(' || 
                              P_NR_CLIENTE || ') QUE É:' || V_NM_CLIENTE);
    
    EXCEPTION
			WHEN NO_DATA_FOUND THEN
				V_NM_CLIENTE := 'CLIENTE DE NÚMERO(' || P_NR_CLIENTE || ') NÃO CADASTRADO!';
			WHEN OTHERS THEN
				RAISE_APPLICATION_ERROR( -20111, 'ERRO CRÍTICO NA FUNÇÃO FUN_DB_PEGA_NOME_CLIENTE, ERRO: ' || SQLERRM);
	END;
	
    RETURN V_NM_CLIENTE;
END FUN_DB_PEGA_NOME_CLIENTE;

-- SOLICITAMOS QUE SEJA EXIBIDO O NOME 
-- DO CLIENTE DE NÚMERO 21
COLUMN FUN_DB_PEGA_NOME_CLIENTE(21) FORMAT A30;
SET SERVEROUTPUT ON;
SELECT FUN_DB_PEGA_NOME_CLIENTE(21) FROM DUAL;
