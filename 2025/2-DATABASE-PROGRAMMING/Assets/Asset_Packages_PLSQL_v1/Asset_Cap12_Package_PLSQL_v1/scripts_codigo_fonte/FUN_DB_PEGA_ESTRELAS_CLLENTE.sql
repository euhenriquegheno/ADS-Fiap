CREATE OR REPLACE FUNCTION FUN_DB_PEGA_ESTRELAS_CLLENTE(
P_NR_CLIENTE DB_CLIENTE.NR_CLIENTE%TYPE) RETURN NUMBER
IS
	-- VARIÁVEL DO TIPO DE DADO DA COLUNA, POIS VAMOS RETORNAR O NOME DO CLIENTE 
	-- A PARTIR DE SEU CÓDIGO QUE REPRESENTA A CHAVE PK.
    V_QT_ESTRELAS DB_CLIENTE.QT_ESTRELAS%TYPE;
BEGIN
	
	BEGIN
		SELECT 	QT_ESTRELAS
		INTO 	V_QT_ESTRELAS
		FROM	DB_CLIENTE
		WHERE	NR_CLIENTE = P_NR_CLIENTE;
	EXCEPTION
			WHEN NO_DATA_FOUND THEN
				V_QT_ESTRELAS := 00;
			WHEN OTHERS THEN
				RAISE_APPLICATION_ERROR( -20111, 'ERRO CRÍTICO NA FUNÇÃO FUN_DB_PEGA_ESTRELAS_CLLENTE, ERRO: ' || SQLERRM);
	END;
	
    RETURN V_QT_ESTRELAS;
END FUN_DB_PEGA_ESTRELAS_CLLENTE;

-- SOLICITAMOS QUE SEJA CAPTURADO A QUANTIDADE
-- DE ESTRELAS DO CLIENTE DE NÚMERO 11
SELECT FUN_DB_PEGA_ESTRELAS_CLLENTE(11) QT_ESTRELAS_CLIENTE FROM DUAL;

-- SOLICITAMOS QUE SEJA CAPTURADO A QUANTIDADE
-- DE ESTRELAS DO CLIENTE DE NÚMERO 9999
SELECT FUN_DB_PEGA_ESTRELAS_CLLENTE(9999) QT_ESTRELAS_CLIENTE FROM DUAL;

