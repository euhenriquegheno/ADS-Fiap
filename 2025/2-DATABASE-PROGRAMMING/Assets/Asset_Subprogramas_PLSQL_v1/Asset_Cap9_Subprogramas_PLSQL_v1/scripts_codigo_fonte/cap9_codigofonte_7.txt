CREATE OR REPLACE PROCEDURE PRC_DB_INSERE_LOJA (
    P_NM_LOJA         IN DB_LOJA.NM_LOJA%TYPE,
    P_DT_INAUGURACAO  IN DB_LOJA.DT_INAUGURACAO%TYPE
) AS
-- Este procedimento armazenado recebe 2 parametros de entrada
-- e armazena esses conteúdos oriundos dos parametros para dentro da tabela DB_LOJA
-- VEJA QUE É POSSÍVEL COLOCAR NOVOS CODIGOS
    V_RETORNO NUMBER;
BEGIN
    -- INSERE UMA LOJA NO PROJETO DBURGER UTILIZNADO O NÚMERO SEQUENCIAL DA LOJA
    -- QUE JÁ SE ENCONTRA ATUALIZADO.
    INSERT INTO DB_LOJA(NR_LOJA, NM_LOJA, DT_INAUGURACAO) 
    VALUES (SQ_DB_LOJA.NEXTVAL, P_NM_LOJA, P_DT_INAUGURACAO);
    V_RETORNO := SQL%ROWCOUNT;
    -- CONFIRMA A TRANSAÇÃO PENDENTE E A NOVA LOJA É INSERIDA.
    DBMS_OUTPUT.PUT_LINE ('A VARIAVEL V_RETORNO POSSUI O VALOR:' || V_RETORNO);
    COMMIT;
EXCEPTION
    -- CASO ENCONTRE ALGUM ERRO, CAPTURAMOS E EXIBIMOS UMA MENSAGEM SIGNIFICATIVA.
    WHEN DUP_VAL_ON_INDEX THEN
        RAISE_APPLICATION_ERROR( -20001, 'PROBLEMAS NO MOMENTO DE INSERIR UMA LOJA. ÍNDICE DUPLICADO NA TABELA DB_LOJA');
    WHEN OTHERS THEN
      RAISE_APPLICATION_ERROR( -20002, 'PROBLEMAS NO MOMENTO DE INSERIR UMA LOJA. || SQLERRM');
END PRC_DB_INSERE_LOJA;
/

