-- Instrução SQL que calcula a quantidade total de vendas dos produtos
-- de uma determinada loja, agrupado por ano e mês de venda.
SELECT  PL.CD_PRODUTO_LOJA,
		EXTRACT( YEAR FROM P.DT_PEDIDO) ANO_VENDA,
        EXTRACT( MONTH FROM P.DT_PEDIDO) MES_VENDA,
		COUNT(IP.QT_PEDIDO) QTD_TOT_VENDAS
FROM    DB_PRODUTO_LOJA PL  INNER JOIN DB_ITEM_PEDIDO IP
ON		(PL.CD_PRODUTO_LOJA = IP.CD_PRODUTO_LOJA) INNER JOIN DB_PEDIDO P
ON		(IP.NR_LOJA = P.NR_LOJA AND IP.NR_PEDIDO = P.NR_PEDIDO)
WHERE   PL.NR_LOJA = 1
AND     EXTRACT( YEAR FROM P.DT_PEDIDO) = 2024
AND     EXTRACT( MONTH FROM P.DT_PEDIDO) = 1
GROUP BY  PL.CD_PRODUTO_LOJA,
		EXTRACT( YEAR FROM P.DT_PEDIDO),
        EXTRACT( MONTH FROM P.DT_PEDIDO);
