CREATE OR REPLACE FUNCTION FUN_DB_CALCULA_TOTVDA_DIASEMANA RETURN NUMBER
IS
-- VARIÁVEL DO TIPO DE DADO DA COLUNA, POIS VAMOS
-- REALIZAR CÁLCULO SOBRE ELA.
V_VL_TOT_VENDA_DIA_SEMANA DB_PEDIDO.VL_TOT_PEDIDO%TYPE;
BEGIN
    SELECT  SUM(VL_TOT_PEDIDO) VAL_TOT_VENDA
    INTO    V_VL_TOT_VENDA_DIA_SEMANA 
    FROM    DB_PEDIDO
    WHERE   TO_CHAR(DT_PEDIDO,'DAY') = TO_CHAR( SYSDATE, 'DAY');
    
    IF V_VL_TOT_VENDA_DIA_SEMANA IS NULL THEN
        V_VL_TOT_VENDA_DIA_SEMANA  := 00;
    END IF;
    
    -- RETORNANDO A VARIÁVEL COM O CÁLCULO REALIZADO
    RETURN V_VL_TOT_VENDA_DIA_SEMANA ;
EXCEPTION
	WHEN OTHERS THEN
		RAISE_APPLICATION_ERROR (-20010, 'ERRO CRÍTICO NA FUNÇÃO FUN_DB_CALCULA_TOTVDA_DIASEMANA ' || SQLERRM);
		
END FUN_DB_CALCULA_TOTVDA_DIASEMANA;

--
-- EXECUTANDO A FUNÇÃO SEM PARÂMETRO
SELECT FUN_DB_CALCULA_TOTVDA_DIASEMANA FROM DUAL;
